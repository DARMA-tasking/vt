name: PR tests (alpine, clang-8, mpich)

on: [pull_request]

jobs:

  build:

    runs-on: ubuntu-latest

    env:
      REPO: lifflander1/vt
      ARCH: amd64
      COMPILER_TYPE: clang
      COMPILER: clang-8
      BUILD_TYPE: release
      ULIMIT_CORE: 0
      VT_LB: 1
      VT_TRACE: 0
      VT_TRACE_RT: 0
      VT_MIMALLOC: 0
      VT_DOCS: 0
      VT_ASAN: 0
      CACHE: ~/.local/cache/

    steps:
    - uses: actions/cache@v1
      with:
        path: ~/.local/cache/
        key: ${{ runner.os }}-alpine-clang-8-${{ hashFiles('**/*') }}
        restore-keys: |
          ${{ runner.os }}-alpine-clang-8-
    - uses: actions/checkout@v1
    - name: Build the Docker image
      run: docker-compose run alpine-cpp
